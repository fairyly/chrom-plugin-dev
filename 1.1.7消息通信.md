# 1.1.7消息通信

## 1. 互相通信概览

>注：-表示不存在或者无意义，或者待验证。



|-| injected-script|	content-script|	popup-js|	background-js
|-- |-- |--|--|--|
injected-script|	-|	window.postMessage|	-|	-|
content-script|	window.postMessage|	-	|chrome.runtime.sendMessage| chrome.runtime.connect	|chrome.runtime.sendMessage |chrome.runtime.connect
popup-js|	-	chrome.tabs.sendMessage |chrome.tabs.connect|	-	|chrome.extension. getBackgroundPage()
background-js|	-	chrome.tabs.sendMessage |chrome.tabs.connect|	chrome.extension.getViews	|-
devtools-js|	chrome.devtools. inspectedWindow.eval	|-	|chrome.runtime.sendMessage|	chrome.runtime.sendMessage


## 2.通信详细介绍
### 2.1popup和background
>popup可以直接调用background中的JS方法，也可以直接访问background的DOM：

```
// background.js
function test()
{
	alert('我是background！');
}

// popup.js
var bg = chrome.extension.getBackgroundPage();
bg.test(); // 访问bg的函数
alert(bg.document.body.innerHTML); // 访问bg的DOM
```

>小插曲，今天碰到一个情况，发现popup无法获取background的任何方法，找了半天才发现是因为background的js报错了，而你如果不主动查看background的js的话，是看不到错误信息的，特此提醒。


## 参考
- [extensions/messaging](https://developer.chrome.com/extensions/messaging)
